"use strict";import"../icon-wc/index.js";import router from"../../tools/router/index.esm.js";const skins={1:"air-green",2:"air-blue",3:"air-pine",4:"air-darkGreen",5:"air-yellow",6:"air-purple"},routeMode={hash:"hash",browser:"pathname"};function setClass(t,r,i){findEl(t,r,function(e){-1<e.className.indexOf("tree-li-childs")&&("child"===t?(e.className="tree-li tree-li-childs tree-li-hide",e.style.height=0,findEl("parent",r,function(e){"tree-li tree-li-childs tree-li-show"===e.className&&(e.style.height=e.offsetHeight-i+"px")})):"parent"===t&&(e.className="tree-li tree-li-childs tree-li-show",e.style.height=e.style.height?e.offsetHeight+i+"px":i+"px"))})}function findEl(e,t,r){for(;"parent"===e&&t.parentElement;)r&&r(t),t=t.parentElement;for(;"child"===e&&t.lastElementChild;)r&&r(t),t=t.lastElementChild}function tagReg(e){return["div","a","p","span","section","Link"].includes(e)}function pickMenuItem(e,t,r){var i,a=[...new Set(e.__DOM__.querySelectorAll(".tree-childs-btn"))],e=[...new Set(e.__DOM__.querySelectorAll(".tree-btn"))];for(i of[...a,...e])t===i[routeMode[r]]?(console.log(i,t),i.style["background-color"]="#38343c"):(console.log(i[routeMode[r]],t),i.style.background="")}function createHref(e,t){return"javascript:;"!==e&&"hash"===t?"#"+e:e}export default class Tree extends HTMLElement{static get observedAttributes(){return["data","color"]}constructor(e){super(e),Object.defineProperty(this,"root",{value:this.attachShadow({mode:"open"}),writable:!0,enumerable:!1,configurable:!0}),Object.defineProperty(this,"props",{value:{data:[],color:"#b7b7b7"},writable:!0,enumerable:!1,configurable:!0}),this.root.innerHTML='<style>* { margin: 0; padding: 0; box-sizing: border-box; } a { text-decoration: none; } a:focus { outline: none; } .air-ui-tree-container { height: 100%; width: inherit; padding: 10px; background: #1B1521; color: #fff; } .air-ui-tree-container .air-ui-tree { height: 100%; } .air-ui-tree-container .air-ui-tree ol, .air-ui-tree-container .air-ui-tree ul { list-style: none; } .air-ui-tree-container .air-ui-tree .tree-ul .tree-li { overflow: hidden; transition: 0.4s; cursor: pointer; } .air-ui-tree-container .air-ui-tree .tree-ul .tree-li .tree-btn { display: block; height: 30px; line-height: 30px; transition: 0.4s; padding: 0 5px; color: inherit; } .air-ui-tree-container .air-ui-tree .tree-ul .tree-li .tree-btn:hover { padding-left: 10px; background: #38343c; } .air-ui-tree-container .air-ui-tree .tree-ul .tree-li .tree-childs-btn { margin: 5px 0; } .air-ui-tree-container .air-ui-tree .tree-ul .tree-li-childs { padding-left: 10px; } .air-ui-tree-container .air-ui-tree .tree-ul .tree-li-show { margin-top: 5px; } .air-ui-tree-container .air-ui-tree .tree-ul .tree-li-hide { height: 0; } </style> <div class="air-ui-tree-container"> <div class="air-ui-tree"></div>  </div> ',this.__ELM__=Array.from(this.root.children),this.__DOM__=this.__ELM__[1],this?.__REGIESTRYCONFIG__();var t={};try{for(var r of Object.keys(t))this[r]=t[r]}catch(e){}}async connectedCallback(){let s=this,{__WCCONFIG__:o={},__BASECONFIG__:c={}}=this;const{mode:h="browser"}=o;pickMenuItem(s,location[routeMode[h]],h),"undefined"!=typeof history&&router.on("*",e=>{pickMenuItem(s,e.target.location[routeMode[h]],h)}),this.__DOM__.setAttribute("style",`color: ${this.props.color};`),this.__DOM__.addEventListener("click",function(r){var e=r.target;let{nodeName:t,className:i,parentElement:a,pathname:l}=e;var n=a.nextElementSibling;if("LI"===t&&"tree-li-head"===i||a&&-1<a.className.indexOf("tree-li-head")){if(n){s.dispatchEvent(new CustomEvent("tree_wc_select",{detail:r}));let{className:e,childElementCount:t}=n;-1<e.indexOf("tree-li-show")?setClass("child",n,30*t+15):setClass("parent",n,30*t+15)}}else-1<i.indexOf("tree-childs-btn")&&pickMenuItem(s,l,h);"A"===t&&"react"===c?.framework&&"browser"===o?.mode&&(r.preventDefault(),"javascript:;"!==e.href&&e.pathname&&o?.history?.push(e.pathname))},!1),this.__DOM__.children[0].innerHTML=this._render(this.props.data)}disconnectedCallback(){console.log("unmount")}attributeChangedCallback(e,t,r){switch(e){case"skin":this.__DOM__.setAttribute("class","air-ui-tree "+(skins[r]||skins[1]));break;case"data":this.props.data=JSON.parse(r);break;case"color":this.props.color=r}}adoptedCallback(){console.log("adopted")}_render(e,t=[],r=1,i=""){var a,l,{__WCCONFIG__:n={}}=this;for([a,l]of e.entries()){var s=tagReg(l.tag)?l.tag:"a",o=l.path?`${"javascript:;"===i?"":i}/`+l.path:"javascript:;",c=createHref(o,n?.mode);l.childs&&l.childs.length?(t.push(`<ul class="tree-ul"> <li class="tree-li tree-li-head"> <${s} class="tree-btn" href="${c}">${l.title}</${s}> </li><li class="tree-li tree-li-childs tree-li-hide">`),this._render(l.childs,t,r,o),r++):a===e.length-1?(t.push(`<${s} class="tree-btn tree-childs-btn" href="${c}">${l.title}</${s}>`+"</li></ul>".repeat(r)),r=1):t.push(`<${s} class="tree-btn tree-childs-btn" href="${c}">${l.title}</${s}>`)}return 1===e.length&&(t.unshift('<ul class="tree-ul"> <li class="tree-li tree-li-head">'),t.push("</li></ul>")),t.join("")}_calculate(e,t){}}